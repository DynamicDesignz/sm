#!/usr/bin/env bash

(( ${#extension_args[@]} > 0 )) ||
  error "An extension name must be specified."

# Parse arguments
while (( ${#extension_args} > 0 )) ; do
  token="$1" ; shift
  case "${token}" in
    to)
      _target="${1}"
      shift
      ;;
    from)
      _source="${1}"
      shift
      ;;

    *)
      if [[ -z "${_source}" ]] ; then
        _source="$token" ; shift
      elif [[ -z "${_target}" ]] ; then
        _target="$token" ; shift
        break # When we have a target we are done.
      fi
      ;;
  esac
done

# Sanity checks
variable_is_nonempty _source ||
  error "A source extension name must be specified."

variable_is_nonempty _target ||
  error "A target extension name must be specified."

extension_is_installed "${_source}" ||
  error "The extension '${_source}' was not found installed, cannot create a new extension from it."

if extension_is_installed "${_target}"
then
  error "The target extension '${_target}' already exists, cannot create it from ${_source}."
fi

copy_directory \
  from "${extensions_development_path}/${_source}" \
  to "${extensions_development_path}/${_target}"

