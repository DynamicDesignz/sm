#!/usr/bin/env bash

source $extension_scripts_path/initialize

if [[ -z "$project" ]] ; then
  echo -e "project must be specified for 'nginx server'"
fi

nginx_config_path="/etc/nginx"

if [[ -s "$extension_templates_path/server.conf.template" ]] ; then
  if [[ ! -d "$shared_path/config/" ]] ; then mkdir -p $shared_path/config/ ; fi
  cp "$extension_templates_path/server.conf.template" "$nginx_config_path/servers/$project.conf"
  sed -i -e "s#{{project}}#$project#g" $nginx_config_path/servers/$project.conf
  exit $?
else
  echo -e "ERROR: $extension_templates_path/server.conf template is missing."
  exit 1
fi

