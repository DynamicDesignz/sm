#!/usr/bin/env bash

# modules filesystem

usage()
{
  modules help
  description "BDSM self-installer."
  actions "  head   - Get the latest BDSM from the git repository master branch
    latest - Download and install the latest BDSM release package"
  show_help
}

true \
  ${repository_url:="git://github.com/wayneeseguin/bdsm"} \
  ${releases_url:="http://bdsm.beginrescueend.com/releases"}

command="usage" # Default

while [[ $# -gt 0 ]] ; do
  token="$1" ; shift
  case "$token" in
    head|master)
      install_head
      ;;

    +([[:digit:]]).+([[:digit:]]).+([[:digit:]])) # x.y.z
      version="${token}"
      install_release
      ;;

    latest|release)
      fetch_version
      install_release
      ;;

    help|usage)
      usage
      exit 0
      ;;

    *)
      usage
      exit 1
      ;;
  esac
done

ensure_files_are_executable "install"

./install
